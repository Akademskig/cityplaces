(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{199:function(e,t,a){e.exports=a(393)},208:function(e,t,a){},393:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(35),o=a.n(s),l=a(412);a(126),a(206),a(208),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(419),c=a(417),u=a(416),p=a(15),d=a(16),h=a(18),m=a(17),g=a(19),f=a(414),y=a(413),v=a(170),b=a(407),E=a(402),P=a(418),w=a(262),S=a(411),C=a(22),k=a.n(C),O=a(32),j="https://maps.googleapis.com/maps/api/geocode/json?",L="https://maps.googleapis.com/maps/api/place/photo?",I="AIzaSyA_h5tnlq-qjVqJVDT8NrusM8eJJ_YTF6s",T=a(82),x=[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],_=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).pIds=[],a.state={places:a.props.places,placesIds:[]},a.input=document.getElementById("searchCityField"),a.currentInfoShow=function(e,t,n){a.state.currentInfoVisible&&t===a.state.currentMarker?a.setState({currentInfoVisible:!1}):a.setState({currentInfoVisible:!0,currentMarker:t,name:e.name})},a.fetchPlaces=function(e,t,n){var r=new a.props.google.maps.LatLng(t.center.lat(),t.center.lng());n&&(r=new a.props.google.maps.LatLng(n.lat,n.lng)),a.setState({center:r});var s,o=new a.props.google.maps.places.PlacesService(t);s=a.props.query&&a.props.query.radius?{location:a.state.center,radius:a.props.query.radius,keyword:a.props.query.keyword}:{location:a.state.center,rankBy:a.props.google.maps.places.RankBy.DISTANCE,keyword:a.props.query.keyword};o.nearbySearch(s,function(e){e.forEach(function(e){a.state.placesIds.includes(e.id)||a.createMarker(e,null,t),a.pIds.push(e.id);var n={placeId:e.place_id,fields:["opening_hours,url"]};o.getDetails(n,function(t){e.opening_hours=t?t.opening_hours:t,e.url=t?t.url:t})}),a.setState({places:e,placesIds:a.pIds}),a.props.getPlaces(a.state.places)})},a.prepareMap=function(e,t){a.map=t,a.setState({places:a.props.places}),t.controls[a.props.google.maps.ControlPosition.TOP_RIGHT].push(M(a.props.closeMap)),a.prepareAutocomplete(t),a.createMarker(null,a.props.currentPosition,t)},a.prepareMarkers=function(e){a.state.places?a.state.places.forEach(function(t){a.createMarker(t,null,e)}):a.props.places.forEach(function(t){a.createMarker(t,null,e)}),a.pIds=[]},a.prepareAutocomplete=function(e){var t=document.getElementById("searchCityField");if(t){var n;(n=new a.props.google.maps.places.Autocomplete(t,{types:["(cities)"]})).bindTo("bounds",e);var r=new a.props.google.maps.InfoWindow,s=document.getElementById("infowindow-content");r.setContent(s),a.props.google.maps.event.addListener(n,"place_changed",function(){r.close();var e=n.getPlace();e.geometry&&(a.setState({autoPlace:{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()}}),a.props.setNewLoc(a.state.autoPlace,e.formatted_address))})}},a.componentDidUpdate=function(){a.props.visible&&a.prepareMarkers(a.map)},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"createMarker",value:function(){var e=Object(O.a)(k.a.mark(function e(t,a,n){var r,s,o,l,i=this;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&(r={lat:t.geometry.location.lat,lng:t.geometry.location.lng},"function"==typeof t.geometry.location.lat&&(r={lat:t.geometry.location.lat(),lng:t.geometry.location.lng()})),s=!1,a&&!this.props.type&&(s=!0),o=new window.google.maps.Marker({map:n,position:a||r,draggable:s,icon:t?{url:t.icon,scaledSize:t.id!==this.props.center.place.id?new this.props.google.maps.Size(25,25):new this.props.google.maps.Size(35,35)}:null}),l=new window.google.maps.InfoWindow,window.google.maps.event.addListener(o,"click",function(){l.setContent(t?A(t):N("You are here")),l.open(n,this)}),window.google.maps.event.addListener(o,"dragend",function(e){i.fetchPlaces(null,n,{lat:e.latLng.lat(),lng:e.latLng.lng()})});case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.close?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(T.Map,{google:this.props.google,zoom:16,visible:this.props.visible,initialCenter:this.props.center,center:this.state.center||this.props.center,onReady:this.prepareMap,styles:x})))}}]),t}(n.Component),M=function(e){var t=document.createElement("div"),a=document.createElement("i");return a.classList="window close outline icon",a.style.color="black",t.classList="ui button big icon",t.style.margin="10px",t.style.padding="10px",t.style.backgroundColor="white",t.style.borderRadius="0",t.appendChild(a),t.addEventListener("click",e),t},N=function(e){return'<div class="ui card" style="width:100px">\n                    <div class="ui card content" style="padding:3px">\n                        <div class="ui header">'.concat(e,"</div>\n                    </div>\n                </div>")},A=function(e){var t;if(e.photos){var a=e.photos[0].photo_reference;t=a?"".concat(L,"maxwidth=150&photoreference=").concat(a,"&key=").concat(I):e.photos[0].getUrl()}var n=['<div style="margin-bottom: 5px">OPENING HOURS</div>'];return e.opening_hours&&e.opening_hours.weekday_text?(e.opening_hours.weekday_text.forEach(function(e){n.push('<div style="padding-bottom:2px">'.concat(e,"</div>"))}),n=n.join("")):n="<div>No additional data</div>",'<div class="ui card">\n                    <div class="ui card content">\n                        <div class="ui header">'.concat(e.name,'</div>\n                    </div>\n                    <div class="ui card content">\n                        <strong class="segment vertical basic">').concat(e.vicinity,'</strong>\n                        <div class="info-image ui segment vertical basic">\n                            <img width="150px" src=').concat(t,'>\n            </div>\n                            <div class="ui segment basic vertical">\n                                ').concat(n,'\n                            </div>\n                            <div class="ui segment basic vertical">\n                                <a target="_blank" href=').concat(e.url,"><div>View on Google maps <div><a>\n                </div>\n                                </div>\n                                </div>")},D=_,q=a(409),F=a(169),z=a(410),B=a(394),U=a(83),V=a.n(U),W=a(37),G=a.n(W),R=function e(){Object(p.a)(this,e),this.url="".concat(window.location.protocol,"//").concat(window.location.host,"/api")},J=function(){function e(){Object(p.a)(this,e),this.init(),this.url=(new R).url,this.placesUrl="".concat(this.url,"/user/places"),this.googleApiNearby="".concat(this.url,"/google-api/nearby-search"),this.googleApiDetails="".concat(this.url,"/google-api/details")}return Object(d.a)(e,[{key:"init",value:function(){var e=Object(O.a)(k.a.mark(function e(){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCurrentPosition();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentPosition",value:function(){var e=Object(O.a)(k.a.mark(function e(t){var a=this;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t||!this.location){e.next=2;break}return e.abrupt("return",this.location);case 2:if(!navigator.geolocation){e.next=4;break}return e.abrupt("return",new Promise(function(e,t){navigator.geolocation.getCurrentPosition(function(){var t=Object(O.a)(k.a.mark(function t(n){return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.latitude=n.coords.latitude,a.longitude=n.coords.longitude,t.next=4,a.getByCurrentLocation();case 4:a.location=t.sent,e({location:a.location,lat:a.latitude,lng:a.longitude});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getByCurrentLocation",value:function(){var e=Object(O.a)(k.a.mark(function e(){var t,a;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(j,"latlng=").concat(this.latitude,",").concat(this.longitude,"&result_type=locality|country&key=").concat(I),e.next=3,G.a.get(t,{dataType:"application/json"});case 3:return a=e.sent,e.abrupt("return",a.data.results[0].formatted_address);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getPlaces",value:function(){var e=Object(O.a)(k.a.mark(function e(t,a,n){var r,s,o;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n?(r=n.lat,s=n.lng):(r=this.latitude,s=this.longitude),o="".concat(this.googleApiNearby,"?lat=").concat(r,"&lng=").concat(s,"&rankby=distance&keyword=").concat(a,"&key=").concat(I),t&&a&&(o="".concat(this.googleApiNearby,"?lat=").concat(r,"&lng=").concat(s,"&radius=").concat(t,"&keyword=").concat(a,"&key=").concat(I)),e.abrupt("return",G.a.get(o,{dataType:"application/json"}));case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getDetails",value:function(){var e=Object(O.a)(k.a.mark(function e(t,a){var n;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.googleApiDetails,"?place_id=").concat(t,"&fields=").concat(a),e.next=3,G.a.get(n,{dataType:"application/json"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"savePlace",value:function(){var e=Object(O.a)(k.a.mark(function e(t){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.post(this.placesUrl,t,{dataType:"application/json"});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"removePlace",value:function(){var e=Object(O.a)(k.a.mark(function e(t,a){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.delete("".concat(this.placesUrl,"/").concat(t,"/").concat(a),{dataType:"application/json"});case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getPlacesForUser",value:function(){var e=Object(O.a)(k.a.mark(function e(t){return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G.a.get("".concat(this.placesUrl,"/").concat(t),{dataType:"application/json"}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),K=a(41),H=function(e,t,a,n,r){switch(e){case"info":K.NotificationManager.info(t,a||"Info",n||3e3,r||null);break;case"success":K.NotificationManager.success(t,a||"Sucess!",n||3e3,r||null);break;case"warning":K.NotificationManager.warning(t,a||"Warning!",n||3e3,r||null);break;case"error":K.NotificationManager.error(t,a||"Error!",n||3e3,r||null)}},Y=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).colors=["yellow","orange","blue","green","red"],a.pages=[],a.setCardNums=function(){window.innerWidth<650?a.setState({items:1}):window.innerWidth<1200?a.setState({items:2}):a.setState({items:3})},a.savePlace=function(e,t){var n=a.state.savedPlaces;a.placesApi.savePlace({user_id:localStorage.getItem("user_id"),place_id:e}).then(function(){return H("success","Place saved.")}),n.push(e),a.setState({savedPlaces:n}),t.target.disabled=!0},a.removePlace=function(e,t){a.placesApi.removePlace(localStorage.getItem("user_id"),e).then(function(){return H("success","Place removed.")}),a.props.updatePlaces(e),a.state.activePage>Math.ceil(a.placesListCount/parseInt(a.state.itemsPerPage))&&a.setState({activePage:Math.ceil(a.placesListCount/parseInt(a.state.itemsPerPage))})},a.paginate=function(e,t,a){a=parseInt(a);var n=(t=parseInt(t))*a-a,r=n+a>e.length?e.length:n+a;return e.slice(n,r)},a.componentWillMount=function(){a.setCardNums(),window.addEventListener("resize",function(e){a.setCardNums()}),a.placesApi.getPlacesForUser(localStorage.getItem("user_id")).then(function(e){e.data.data.forEach(function(e){a.state.savedPlaces.push(e.place_id)})}),"save"===a.props.type&&a.setState({placesList:a.state.savedPlaces})},a.handlePageChange=function(e,t){a.setState({activePage:t.activePage})},a.handleItemsPerPageChange=function(e){a.setState({itemsPerPage:e.target.value}),a.state.activePage>Math.ceil(a.placesListCount/parseInt(e.target.value))&&a.setState({activePage:Math.ceil(a.placesListCount/parseInt(e.target.value))})},a.placesApi=new J,a.state={items:3,savedPlaces:[],placesList:a.props.placesList,pages:[],activePage:1,itemsPerPage:6},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("resize",function(t){e.setCardNums()})}},{key:"render",value:function(){return this.props.placesList&&0!==this.props.placesList.length?(this.pages=this.paginate(this.props.placesList,this.state.activePage,this.state.itemsPerPage),this.placesListCount=this.props.placesList.length,this.totalPages=Math.ceil(this.placesListCount/this.state.itemsPerPage),r.a.createElement("div",null,r.a.createElement(P.a,{stackable:!0,columns:2},r.a.createElement(w.a,null,r.a.createElement("div",{style:{marginBottom:"14px"}},r.a.createElement(q.a,{activePage:this.state.activePage,totalPages:this.totalPages,onPageChange:this.handlePageChange.bind(this)})),r.a.createElement(F.a,{color:"teal",size:"large"},"Total items: ".concat(this.placesListCount))),r.a.createElement(w.a,{textAlign:"right"},r.a.createElement(E.a,{name:"rows",type:"number",label:{content:"Max Displayed Items",color:"teal"},value:this.state.itemsPerPage,min:"1",max:this.placesListCount,onChange:this.handleItemsPerPageChange}))),r.a.createElement(Z,Object.assign({},this.props,{pages:this.pages,savedPlaces:this.state.savedPlaces,savePlace:this.savePlace,removePlace:this.removePlace,items:this.state.items})))):r.a.createElement("div",{style:{textAlign:"center"}},"No places found.")}}]),t}(n.Component),Q=function(e){return e.hasOwnProperty("opened")&&"OPENED"===e.opened?r.a.createElement("p",{style:{color:"green"}},"OPENED"):e.hasOwnProperty("opened")&&"CLOSED"===e.opened?r.a.createElement("p",{style:{color:"red"}},"CLOSED"):r.a.createElement("p",null,"?")},X=function(e){return"save"!==e.type?r.a.createElement(S.a,{compact:!0,icon:{name:"save"},disabled:e.disabled,color:e.saveButtonColor,onClick:e.savePlace}):r.a.createElement(S.a,{compact:!0,icon:{name:"circle remove"},color:"red",onClick:e.removePlace})},Z=function(e){var t=["yellow","orange","blue","green","red"];return r.a.createElement(z.a.Group,{itemsPerRow:e.items},e.pages.map(function(a){var n=a.geometry.location.lat,s=a.geometry.location.lng,o=U.sample(t),l="?",i="",c=!1;if(e.savedPlaces.includes(a.place_id)&&(c=!0),a.photos){var u=a.photos[0].photo_reference;i=u?"".concat(L,"maxwidth=200&photoreference=").concat(u,"&key=").concat(I):a.photos[0].getUrl()}return a.opening_hours&&a.opening_hours.open_now&&(l="OPENED"),a.opening_hours&&!a.opening_hours.open_now&&(l="CLOSED"),r.a.createElement(z.a,{color:o,key:a.id},r.a.createElement(z.a.Content,null,r.a.createElement(z.a.Header,null,r.a.createElement(P.a,{columns:2},r.a.createElement(P.a.Column,{width:12},a.name),r.a.createElement(P.a.Column,{textAlign:"right",width:4},r.a.createElement(B.a,{size:"mini",src:a.icon}))))),r.a.createElement(z.a.Content,null,r.a.createElement(P.a,{columns:2,height:"100%"},r.a.createElement(P.a.Column,{verticalAlign:"middle"},r.a.createElement(z.a.Meta,null,r.a.createElement(v.a,{name:"star"}),a.rating),r.a.createElement(f.a,{vertical:!0,basic:!0,compact:!0,style:{paddingBottom:0}},r.a.createElement(z.a.Description,null,a.vicinity,r.a.createElement(Q,{opened:l}))),r.a.createElement(f.a,{basic:!0,vertical:!0,style:{paddingBottom:0}},r.a.createElement(v.a,{onClick:e.showMap.bind(void 0,n,s,a),className:"map-icon",title:"Map",name:"map",color:"blue"}))),r.a.createElement(P.a.Column,null,r.a.createElement("span",{style:{borderRadius:"5px",height:"100px",float:"right",overflow:"hidden"}},r.a.createElement(B.a,{src:i,size:"small",rounded:!0})))),r.a.createElement(f.a,{basic:!0,vertical:!0,textAlign:"right",style:{marginBottom:0}},r.a.createElement(X,{placeId:a.place_id,removePlace:e.removePlace.bind(void 0,a.place_id),savePlace:e.savePlace.bind(void 0,a.place_id),type:e.type,saveButtonColor:"orange",disabled:c}))))}))},$=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).colors=["blue","purple","orange","red","yellow"],a.items=3,a.state={items:3,lat:a.props.currentPosition.lat,lng:a.props.currentPosition.lng,mapVisible:!1,close:!1},a.showMap=function(e,t,n){"function"==typeof e&&(e=e(),t=t()),a.state.mapVisible?a.setState({mapVisible:!1}):a.setState({lat:e,lng:t,mapVisible:!0,place:n,close:!1})},a.closeMap=function(e,t){a.setState({mapVisible:!1,close:!0})},a.setNewLoc=function(e){a.props.setNewLoc({lat:e.lat,lng:e.lng})},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return this.props.currentPosition.lat?r.a.createElement("div",null,r.a.createElement("div",{hidden:!this.state.mapVisible,className:"map-container "},r.a.createElement(D,Object.assign({},this.props,{type:this.props.type,visible:this.state.mapVisible,center:{lat:this.state.lat,lng:this.state.lng,place:this.state.place},places:this.props.placesList,currentPosition:this.props.currentPosition,resetMap:this.resetMap,loading:!0,closeMap:this.closeMap,getPlaces:this.props.getPlaces,query:this.props.query,close:this.state.close,setNewLoc:this.props.setNewLoc}))),r.a.createElement(Y,{type:this.props.type,placesList:this.props.placesList,userPlaces:this.state.userPlaces,showMap:this.showMap,updatePlaces:this.props.updatePlaces})):r.a.createElement("div",null)}}]),t}(n.Component),ee=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(m.a)(t).call(this))).state={loading:!0,position:"",mapVisible:!1,lat:null,lng:null},e.getFormData=function(t){e.setState(t)},e.getPosition=function(t){e.setState({loading:!0}),e.gma.getCurrentPosition(t).then(function(t){e.setState({loading:!1,position:t.location,lat:t.lat,lng:t.lng})}).catch(function(t){H("error",t.message),e.setState({loading:!1})})},e.getPlacesFromMap=function(t){e.setState({filteredPlaces:t,placesList:t})},e.getPlaces=function(t){e.setState({loadingPlaces:!0}),e.gma.getPlaces(t.radius,t.keyword,{lat:e.state.lat,lng:e.state.lng}).then(function(t){var a=t.data.data;a.forEach(function(t){e.gma.getDetails(t.place_id,"opening_hours,url").then(function(e){t.opening_hours=e.data&&e.data.data?e.data.data.opening_hours:null,t.url=e.data&&e.data.data?e.data.data.url:null}).catch(function(t){H("error",t.message),e.setState({loadingPlaces:!1})})}),e.setState({loadingPlaces:!1,placesList:a,filteredPlaces:a})}).catch(function(t){H("error",t.message),e.setState({loadingPlaces:!1})}),e.setState({query:t})},e.handleSearch=function(t){var a=e.state.placesList?e.state.placesList.filter(function(e){return e.name.toLowerCase().match(t.toLowerCase())}):null;e.setState({filteredPlaces:a})},e.gma=new J,e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){this.getPosition(!1)}},{key:"render",value:function(){return r.a.createElement(f.a.Group,null,r.a.createElement(f.a,{textAlign:"center",loading:this.state.loading},r.a.createElement(te,{location:this.state.position,resetPosition:this.getPosition})),r.a.createElement(f.a,null,r.a.createElement(ae,{getPlaces:this.getPlaces,onSearch:this.handleSearch})),r.a.createElement(f.a,{loading:this.state.loadingPlaces},r.a.createElement($,Object.assign({},this.props,{query:this.state.query,placesList:this.state.filteredPlaces,getPlaces:this.getPlacesFromMap,currentPosition:{lat:this.state.lat,lng:this.state.lng}}))))}}]),t}(n.Component),te=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).reset=function(e){e.preventDefault(),a.props.resetPosition(!0)},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(y.a,{style:{opacity:1},size:"medium",icon:!0},r.a.createElement(v.a,{name:"building",size:"small"}),this.props.location))}}]),t}(n.Component),ae=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={keyword:"karaoke",radius:"300"},a.handleSearch=function(e){a.props.onSearch(e.target.value)},a.handlePlaceChange=function(e){a.setState({keyword:e.target.value})},a.handleRadiusChange=function(e){a.setState({radius:e.target.value})},a.handleSubmit=function(){a.props.getPlaces(a.state)},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,{onSubmit:this.handleSubmit.bind(this)},r.a.createElement(b.a.Group,{widths:"2"},r.a.createElement(b.a.Field,null,r.a.createElement(E.a,{onChange:this.handlePlaceChange.bind(this),icon:"building",iconPosition:"left",placeholder:"Search places",value:this.state.keyword})),r.a.createElement(b.a.Field,null,r.a.createElement(E.a,{onChange:this.handleRadiusChange.bind(this),type:"number",min:"50",step:"50",label:"m",labelPosition:"right",icon:"location arrow",iconPosition:"left",value:this.state.radius,placeholder:"Set radius (m)"}))),r.a.createElement(P.a,{columns:2},r.a.createElement(w.a,null,r.a.createElement(S.a,{icon:!0,color:"orange",labelPosition:"left",disabled:!this.state.keyword},r.a.createElement(v.a,{name:"location arrow"}),"Go")),r.a.createElement(w.a,{textAlign:"right"},r.a.createElement("div",{className:"ui transparent icon input"},r.a.createElement(E.a,{icon:"search",iconPosition:"left",placeholder:"Search...",className:"prompt",floated:"right",onChange:this.handleSearch.bind(this)})))))}}]),t}(n.Component),ne=a(405),re=a(415),se=a(408),oe=a(404),le=function(){function e(){Object(p.a)(this,e),this.tokenPrefix="Bearer",this.url=(new R).url}return Object(d.a)(e,[{key:"createUser",value:function(e){return G.a.post(this.url+"/users",{userCredentials:e}).then(function(e){return e}).catch(function(e){return Promise.reject(e)})}},{key:"signIn",value:function(e){var t=this;return G.a.post(this.url+"/auth/signin",{userCredentials:e}).then(function(e){return localStorage.setItem("user_id",e.data.user._id),localStorage.setItem("user_name",e.data.user.name),t.username=e.data.user.name,t.token=e.data.token,e}).catch(function(e){return Promise.reject(e)})}}]),e}(),ie=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).loginService=new le,a.state={username:localStorage.getItem("user_name")},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(re.a,{attached:"top"},r.a.createElement(se.a,{text:"Menu",item:!0},r.a.createElement(se.a.Menu,null,r.a.createElement(se.a.Item,{as:oe.a,to:"/locations/current"},"Current Location"),r.a.createElement(se.a.Item,{as:oe.a,to:"/locations/other"},"Other Locations"),r.a.createElement(se.a.Item,{as:oe.a,to:"/locations/saved"},"Saved Places"))),r.a.createElement(re.a.Item,{position:"right"},r.a.createElement(se.a,{text:this.state.username?r.a.createElement("div",null,r.a.createElement(v.a,{name:"user"})," ".concat(this.state.username)):null},r.a.createElement(se.a.Menu,{className:"rightDropdown"},r.a.createElement(se.a.Item,null,"View Profile"),r.a.createElement(se.a.Item,{as:oe.a,to:"/login"},"Logout")))))}}]),t}(n.Component),ce=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(ne.a,null,r.a.createElement(ie,null),r.a.createElement(Ee,null),r.a.createElement(K.NotificationContainer,null))}}]),t}(n.Component),ue=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(m.a)(t).call(this))).getPosition=function(t){e.setState({loading:!0}),e.gma.getCurrentPosition(t).then(function(t){e.setState({loading:!1,location:t.location,lat:t.lat,lng:t.lng})}).catch(function(t){H("error",t.message),e.setState({loadingPlaces:!1})})},e.setNewLoc=function(t,a){e.setState({lat:t.lat,lng:t.lng}),e.setState({location:a})},e.state={loading:!1,loadingPlaces:!1,location:"!"},e.getPlaces=function(t){e.setState({loadingPlaces:!0}),e.gma.getPlaces(t.radius,t.keyword,{lat:e.state.lat,lng:e.state.lng}).then(function(t){var a=t.data.data;a.forEach(function(t){e.gma.getDetails(t.place_id,"opening_hours,url").then(function(e){t.opening_hours=e.data&&e.data.data?e.data.data.opening_hours:null,t.url=e.data&&e.data.data?e.data.data.url:null}).catch(function(t){H("error",t.message),e.setState({loadingPlaces:!1})})}),e.setState({loadingPlaces:!1,placesList:a,filteredPlaces:a})}).catch(function(t){H("error",t.message),e.setState({loadingPlaces:!1})}),e.setState({query:t})},e.handleSearch=function(t){var a=e.state.placesList?e.state.placesList.filter(function(e){return e.name.toLowerCase().match(t.toLowerCase())}):null;e.setState({filteredPlaces:a})},e.getPlacesFromMap=function(t){e.setState({filteredPlaces:t,placesList:t})},e.onKeyword=function(t){e.setState({query:{keyword:t}})},e.gma=new J,e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){this.getPosition(!1)}},{key:"render",value:function(){return r.a.createElement(f.a.Group,null,r.a.createElement(f.a,{textAlign:"center",loading:this.state.loading},r.a.createElement(de,{location:this.state.location})),r.a.createElement(f.a,null,r.a.createElement(pe,{onKeyword:this.onKeyword,findPlaces:this.getPlaces,onSearch:this.handleSearch})),r.a.createElement(f.a,{loading:this.state.loadingPlaces},r.a.createElement($,Object.assign({},this.props,{setNewLoc:this.setNewLoc,query:this.state.query,placesList:this.state.filteredPlaces,getPlaces:this.getPlacesFromMap,currentPosition:{lat:this.state.lat,lng:this.state.lng}}))))}}]),t}(n.Component),pe=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={city:"",keyword:"karaoke"},a.handleSearch=function(e){a.props.onSearch(e.target.value)},a.handlePlaceChange=function(e){a.setState({keyword:e.target.value})},a.handleCityChange=function(e){a.setState({city:e.target.value})},a.handleSubmit=function(){a.props.findPlaces(a.state)},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(b.a,{onSubmit:this.handleSubmit.bind(this)},r.a.createElement(b.a.Group,{widths:"2"},r.a.createElement(b.a.Field,null,r.a.createElement(E.a,{onChange:this.handlePlaceChange.bind(this),icon:"building",iconPosition:"left",placeholder:"Search city places",value:this.state.keyword})),r.a.createElement(b.a.Field,null,r.a.createElement(E.a,{id:"searchCityField",type:"text",ref:function(t){return e.autocomplete=t},placeholder:"Search cities"})),r.a.createElement("div",{id:"infowindow-content"})),r.a.createElement(P.a,{columns:2},r.a.createElement(w.a,null,r.a.createElement(S.a,{icon:!0,color:"orange",labelPosition:"left",disabled:!this.state.keyword},r.a.createElement(v.a,{name:"location arrow"}),"Go")),r.a.createElement(w.a,{textAlign:"right"},r.a.createElement("div",{className:"ui transparent icon input"},r.a.createElement(E.a,{icon:"search",iconPosition:"left",placeholder:"Search...",className:"prompt",floated:"right",onChange:this.handleSearch.bind(this)})))))}}]),t}(n.Component),de=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(y.a,{size:"medium",icon:!0},r.a.createElement(v.a,{name:"building",size:"small"}),this.props.location))}}]),t}(n.Component),he=a(406),me=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(m.a)(t).call(this))).state={buttonColorCreateNew:"yellow",buttonColorSignIn:"orange",type:"signIn"},e.login=function(t,a){var n={username:t,password:a};"signIn"===e.state.type?e.loginService.signIn(n).then(function(t){e.props.history.push("/"),H("success","Welcome ".concat(t.data.user.name,"!"))}).catch(function(e){console.log(e),H("error",e.response&&e.response.data.error||e.message)}):"createNew"===e.state.type&&e.loginService.createUser(n).then(function(t){e.setState({type:"signIn"}),H("success",t.data.message)}).catch(function(e){H("error",e.response&&e.response.data.error||e.message)})},e.selectSignIn=function(t){e.setState({buttonColorSignIn:"orange",buttonColorCreateNew:"yellow",type:"signIn"})},e.selectLogIn=function(t){e.setState({buttonColorSignIn:"yellow",buttonColorCreateNew:"orange",type:"createNew"})},e.componentWillMount=function(){localStorage.clear()},e.loginService=new le,e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(ne.a,{text:!0,style:{marginTop:"50px"}},r.a.createElement(f.a,{size:"tiny"},r.a.createElement(P.a,{columns:3},r.a.createElement(w.a,null),r.a.createElement(w.a,null,r.a.createElement(y.a,{textAlign:"center",size:"large"},"signIn"===this.state.type?"Sign In":"Register")),r.a.createElement(w.a,{textAlign:"right"},r.a.createElement(S.a,{color:this.state.buttonColorSignIn,onClick:this.selectSignIn},"Sign In"),r.a.createElement(S.a,{color:this.state.buttonColorCreateNew,onClick:this.selectLogIn},"Register"))),r.a.createElement(he.a,null),r.a.createElement(ge,{login:this.login})),r.a.createElement(K.NotificationContainer,null))}}]),t}(n.Component),ge=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",passInputType:"password"},a.handleUserChange=function(e){a.setState({username:e.target.value})},a.handlePasswordChange=function(e){a.setState({password:e.target.value})},a.handleSubmit=function(){a.props.login(a.state.username,a.state.password)},a.changePassType=function(){"password"===a.state.passInputType?a.setState({passInputType:"text"}):a.setState({passInputType:"password"})},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,{onSubmit:this.handleSubmit.bind(this)},r.a.createElement(b.a.Field,null,r.a.createElement("label",{basic:"true"},"Username"),r.a.createElement(E.a,{onChange:this.handleUserChange.bind(this),icon:"user circle",placeholder:"Choose username",value:this.state.username})),r.a.createElement(b.a.Field,null,r.a.createElement("label",{basic:"true"},"Password"),r.a.createElement(E.a,{onChange:this.handlePasswordChange.bind(this),type:this.state.passInputType,value:this.state.password,placeholder:"Choose password"},r.a.createElement("input",null),r.a.createElement(S.a,{basic:!0,type:"button",onClick:this.changePassType,icon:"eye"}))),r.a.createElement(f.a,{textAlign:"center",basic:!0},r.a.createElement(S.a,{color:"teal",disabled:!this.state.username||!this.state.password},"LOGIN")))}}]),t}(n.Component),fe=a(403),ye=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(h.a)(this,Object(m.a)(t).call(this))).state={loadingPlaces:!0,filteredPlaces:[],placesList:[],citiesList:[]},e.getPosition=function(t){e.setState({loading:!0}),e.gma.getCurrentPosition(t).then(function(t){e.setState({loading:!1,position:t.location,lat:t.lat,lng:t.lng})}).catch(function(t){H("error",t.message),e.setState({loading:!1})})},e.handleSearch=function(t){var a=e.state.filteredCities?e.state.filteredCities.filter(function(e){return e.name.toLowerCase().match(t.toLowerCase())}):null;e.setState({filteredPlaces:a})},e.filterCities=function(t,a){if("all"!==a.value){var n=e.state.placesList?e.state.placesList.filter(function(e){return e.city.match(a.value)}):null;e.setState({filteredPlaces:n,filteredCities:n})}else e.setState({filteredPlaces:e.state.placesList,filteredCities:e.state.placesList})},e.updatePlaces=function(t){var a=e.state.filteredPlaces.filter(function(e){return e.place_id!==t});e.setState({filteredPlaces:a})},e.componentWillMount=function(){e.getPosition(),e.gma.getPlacesForUser(localStorage.getItem("user_id")).then(function(t){var a=[],n=[{key:"all",text:"All",flag:"eu",value:"all"}];0!==t.data.data.length?t.data.data.forEach(function(r,s){var o={placeId:r.place_id,fields:[]};e.gma.getDetails(o.placeId,o.fields).then(function(r){var o=r.data.data.address_components.find(function(e){return e.types.includes("locality")}).long_name,l=r.data.data.address_components.find(function(e){return e.types.includes("country")}).long_name.toLowerCase();n.push({key:s,text:o,flag:l,value:o}),a.push(Object.assign(r.data.data,{city:o})),a.length===t.data.data.length&&e.setState({placesList:a,filteredPlaces:a,filteredCities:a,loadingPlaces:!1,citiesList:V.a.uniqBy(n,"text")})})}):e.setState({placesList:a,filteredPlaces:a,loadingPlaces:!1})})},e.gma=new J,e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(f.a.Group,null,r.a.createElement(f.a,{textAlign:"center"},r.a.createElement(y.a,{size:"medium",icon:!0},r.a.createElement(v.a,{name:"save",size:"small"}),"Saved Places")),this.state.citiesList.length>0?r.a.createElement(f.a,null,r.a.createElement(ve,{filterCities:this.filterCities,citiesList:this.state.citiesList,onSearch:this.handleSearch})):null,r.a.createElement(f.a,{loading:this.state.loadingPlaces},r.a.createElement($,Object.assign({},this.props,{updatePlaces:this.updatePlaces,type:"save",setNewLoc:this.setNewLoc,query:this.state.query,placesList:this.state.filteredPlaces,getPlaces:this.getPlacesFromMap,currentPosition:{lat:this.state.lat,lng:this.state.lng}}))))}}]),t}(n.Component),ve=function(e){return r.a.createElement(f.a,{basic:!0,vertical:!0,textAlign:"right"},r.a.createElement(fe.a,{onChange:e.filterCities,style:{marginRight:"14px"},placeholder:"Select City",options:e.citiesList}),r.a.createElement(E.a,{icon:"search",iconPosition:"left",placeholder:"Search...",className:"prompt",floated:"right",onChange:function(t){e.onSearch(t.target.value)}}))},be=function(e){return localStorage.getItem("user_name")?r.a.createElement(ce,null):r.a.createElement(u.a,{to:"/login"})},Ee=Object(T.GoogleApiWrapper)({apiKey:I})(function(e){return r.a.createElement(i.a,null,r.a.createElement(c.a,{path:"/locations/current",render:function(){return r.a.createElement(ee,e)}}),r.a.createElement(c.a,{path:"/locations/other",render:function(){return r.a.createElement(ue,e)}}),r.a.createElement(c.a,{path:"/locations/saved",render:function(){return r.a.createElement(ye,e)}}))}),Pe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={error:null,errorInfo:null},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?r.a.createElement("div",null,r.a.createElement("h2",null,"Something went wrong."),r.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),r.a.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children}}]),t}(n.Component);o.a.render(r.a.createElement(Pe,null,r.a.createElement(l.a,null,r.a.createElement(function(e){return r.a.createElement(i.a,null,r.a.createElement(c.a,{exact:!0,path:"/",render:function(){return r.a.createElement(u.a,{to:"/locations/current"})}}),r.a.createElement(c.a,{path:"/locations",component:be}),r.a.createElement(c.a,{path:"/login",component:me}))},null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[199,2,1]]]);
//# sourceMappingURL=main.d2ffb794.chunk.js.map